const UI={bg:doc.body.ap(El("div","msg-bg",{n:0})),menu:doc.body.ap(El("div",0,{id:"menu"})),tip:doc.body.ap(El("div",0,{id:"mt"})),showMenu(){css(this.menu,{opacity:1,pointerEvents:"auto"}),ac(this.menu.ch,""),$("setting")._h(),this.bg.n&&$c("msg",this.bg).for(t=>{t.onMenu&&(dac(UI.menu.ch,""),this.menu.ap(t).style.animation="none")}),this.menu.on=!0},hideMenu(){css(this.menu,{opacity:0,pointerEvents:""}),css($("setting"),{opacity:0,transform:""}),this.bg.n&&$c("msg",this.menu).for(t=>{t.onMenu&&(this.bg.ap(t).style.animation="none")}),this.menu.on=!1},showTips(t,e,s){e&&(this.tip.style.transform=`translate(${e}px,${s}px)`),this.tip.tx(t).style.display="block"},bindCat(t){$c("setcat",t).for((e,s)=>{e.i=s,e.p=t,e.onclick=function(){css($c("setcat",this.p),{background:"",color:""},this.i,{background:"var(--bgl)",color:"var(--cs)"});let t=$c("setpage",this.p);css(t,{display:""},this.i,{display:"block"}),t[this.i].set(this.p._tab),this.p._tab=this}})},M:class{constructor(t,e,s,i="#0000"){css(UI.bg,{backgroundColor:i,opacity:1,pointerEvents:"auto"}),s=UI.menu.on&&s,dac(s?UI.menu.ch:UI.bg.ch,""),this.box=(s?UI.menu:UI.bg).ap(El("div","msg")),this.box.onMenu=s,t&&(this.box.style.width=t+"px"),e&&(this.box.style.height=e+"px"),UI.bg.n++,this.r={}}t(...t){return t.for(t=>this.box.ap(El("p").tx(t))),this}b(...t){let e=this.box.ap(El("div","a-cen"));return t.for((t,s)=>{e.ap(El("div","btn").tx(t)).onclick=()=>{this.r.i=s,this.r.s=t,this.ok()}}),this}h(t){return this.box.ap(El("h1","kid").tx(t)),this}a(t){return this.box.ap(El("div","msg-area",{innerHTML:t})),this}ac(...t){return this.box.ap(El("div","msg-area")._c(...t)),this}ip(t,e){let s=this.box.ap(El("input"));return s.oninput=()=>this.r.v=s.value,(s.value=t)&&s.oninput(),e&&(s.type=e),this}cb(){return this.box.ap(El("div","msg-cb")).onclick=()=>this.close(),this}ap(t){return this.box.ap(t),this}then(t){this.fin=t}ok(){this.fin&&this.fin(this.r),this.hold?$c("btn",this.box).for(t=>t.aC("gray")):this.close()}close(){if(css(this.box,{animation:"msg-close 0.4s forwards",animationPlayState:"running",pointerEvents:"none"}),--UI.bg.n||css(UI.bg,{opacity:0,pointerEvents:"none"}),setTimeout(this.des,400,this),this.box.pN===UI.menu){let t=this.box.pS();t.onMenu?ac(t):ac(UI.menu.ch)}else{let t=this.box.pS();t&&ac(t)}}des(t){t.box.remove(),t.box=null}},$a:(t,e)=>new UI.M(0,0,e).t(t).b("0{5}"),$q:(t,e,s="1{5}",i="1{6}")=>new UI.M(0,0,e).t(t).b(s,i),prompt:(t,e="")=>(new UI.M).t(t).ip(e).b("0{5}","0{6}"),check:(t,e="0{5}")=>(new UI.M).t(t).ip("").b(e),message(t,e,s=0,i="#49e"){let o=El("div","msg-tip")._c(El("h5").tx(t),El("p").tx(e));return s&&(o.t=setTimeout(()=>o.lastChild.click(),1e3*s)),o.firstChild.style.background=i,o.ap(El("div","msg-cb")).onclick=()=>{o.f?.(),clearTimeout(o.t),css(o,{animation:"tip-close 0.4s forwards",pointerEvents:"none"}),setTimeout(()=>o.remove(),400)},doc.body.ap(o),o.then=t=>o.f=t,o},ico:t=>`<svg><use href='#-${t}'></use></svg>`,p(t,e){let s=El("p");return s.innerHTML=t,e&&(s.style.margin=e),s},span(t,e,s){let i=El("span");return i.innerHTML=t," "===t.at(-1)&&(i.style.marginRight="16px"),e&&(i.style.color=e),s&&(i.style.fontSize=s+"px"),i},help(t,e){let s=El("span","help",{innerHTML:UI.ico("help")});return e&&(s.style.marginRight="16px"),s.h=t,s.onclick=function(t){t.stopPropagation(),App.help(this.h)},s},copy(t){let e=El("div","ib"),s=UI.span(UI.ico("copy")),i=UI.span("✓");return css(i,{padding:"2px",color:"var(--cs)"}),s.aC("username"),i._h(),e.ap(s,i).onclick=()=>navigator.clipboard.writeText(t).then(()=>{s._h(),i._s(),setTimeout((t,e)=>{t._s(),e._h()},1500,s,i)}),e},ipf:El("input",0,{type:"file",multiple:!1}),file:(t,e)=>new Promise((s,i)=>{UI.ipf.accept=t,UI.ipf.onchange=()=>$M.read(UI.ipf.files[0],"string"==typeof e?e:e(UI.ipf.files[0].name)).then(t=>s([t,UI.ipf.files[0].name])).catch(i),UI.ipf.value="",UI.ipf.click()}),on(t){return t.on=e=>(t.f=e,t),t},S(t,e=!1,s=!1){let i=El("div").tx(t),o=El("div",e?"sw on":"sw");return s&&(i.aC("ib"),i.style.marginRight="12px"),i.ap(o).onclick=t=>{i.v=!i.v,i.v?o.aC("on"):o.rC("on"),t&&i.f?.(0|i.v,i)},i.set=t=>{!t!=!i.v&&o.onclick()},i.v=e,this.on(i)},B(t,e){let s=El("div",e?"btn s":"btn").tx(t);return s.set=t=>t?s.rC("gray"):s.aC("gray"),s.onclick=()=>{s.hC("gray")||s.f(s)},this.on(s)},B2(t){let e=El("div","btn2");return e.innerHTML=t,e.onclick=()=>e.f(e),this.on(e)},C(...t){let e=El("div").tx(t[0]),s=e.ap(El("div","chs"));e.v=0,e.m=t[1],e.set=(i,o)=>{for(let o=2;o<t.length;o++)!(i&1<<o-2)!=!(e.v&1<<o-2)&&s.ch[o-2].onclick();o&&e.f(e.v,o)};for(let i=2;i<t.length;i++){let o=El("span").tx(t[i]);s.ap(o).onclick=t=>{if(!e.m&&e.v==1<<i-2)return;e.m?e.v^=1<<i-2:(e.v=1<<i-2,css(s.ch,{color:"",background:""}));let n=o.style.color;css(o,{color:n?"":"var(--cs)",background:n?"":"var(--bgl)"}),t&&e.f(e.v,t)}}return this.on(e)},mbS(t){let e=t.lastChild,s=t.pN;e._s(),e.B=s.B+e.offsetHeight,e.H=s.H,css(e,e.B>s.H?{top:"unset",bottom:0}:{top:"",bottom:""}),s.R?(css(e,{left:"unset",right:"100%"}),e.R=s.R):css(e,{left:"",right:""})},option(t,e,s){let i=El("div","mb");return i._h(),i.w=0,i.hide=function(){this._h(),this.hC("T")?this.remove():this.pN.hC("op")&&this.pN.pN.hide()},s.for((s,o)=>{let n=""===e?o:e+"."+(o+1),a=i.ap(El("div","op"));if(Array.isArray(s)){let[e,o]=s[0].split("#");o?a.innerHTML=UI.ico(o)+" "+e:a.tx(e),a.aC("arr"),"function"==typeof s[1]?(a.ap(El("div","mb")).hide=i.hide,a.f=s[1],a.j=n,a.p=t,a.onmouseover=function(e){if(e.target!==this)return;let s=this.ch[0],i=this.f();s.innerHTML="",i.for((e,i)=>{let o=e.split(":"),n=s.ap(El("div","op")).tx(o[0]);n.v=o[1]||this.j+"."+i,n.onclick=()=>{this.p.v=n.v,this.p.firstChild.tx(n.innerText),this.pN.hide(),this.p.f(t.v)}}),s._s()}):(i.w=Math.max(i.w,a.ap(UI.option(t,n,s.slice(1))).w),a.onmouseover=function(t){t.target===this&&UI.mbS(this)})}else{let[e,o]=s.split(":");e=e.split("#"),e[1]?a.innerHTML=UI.ico(e[1])+" "+e[0]:a.tx(e[0]),e=e[0],a.v=o||n,a.onclick=()=>{t.v=a.v,t.firstChild?.tx(a.innerText),i.hide(),t.f?.(t.v,a.innerText,a)}}}),i.w+=64,i},mbO(t,e){let s=e.pN,i=e.offsetLeft,o=e.offsetTop;for(;s!==doc.body&&!s.hC("page")&&!s.hC("pointer");){if(i+=s.offsetLeft,o+=s.offsetTop,s.hC("setpage")||s.hC("msg-area")){s=s.pN;break}s=s.pN}let n=s.scrollWidth-8,a=s.scrollHeight-8;s.ap(t)._s();let l=i+t.offsetWidth,r=o+t.offsetHeight;if(l>n){let s=e.offsetWidth-t.offsetWidth;i+=s,l+=s}t.R=l+t.w-64>n;let p=r>a?6-t.offsetHeight:e.offsetHeight;o+=p,r+=p,t.H=a,t.B=r,css(t,{top:o+"px",left:i+"px"})},mb(t,e,s){let i=UI.option(t,"",e);return i.aC("T"),s&&css($c("op",i),{minWidth:s+"px"}),i.onmouseleave=i.hide,i.open=()=>{i.style.display?UI.mbO(i,t):i.hide()},i},O(...t){let e=El("div","sl"),s=UI.mb(e,t);return e.ap(El("span")).tx("0{2q}"),e.v=0,e.m=s,e.set=(t=0)=>{let i=Number(t),o=(s,i)=>{for(let n=0;n<s.length;n++){if(s[n].v==t)return void e.firstChild.tx(s[n].innerText);if(s[n].ch[0])if(s[n].f){let o=s[n].f();for(let s=0;s<o.length;s++){let[n,a]=o[s].split(":");if((a||i+"."+s)==t)return void e.firstChild.tx(n)}}else o(s[n].ch[0].ch,""===i?n:i+"."+n)}};e.v=isNaN(i)?t:i,o(s.ch,"")},e.onclick=()=>s.open(),e.onmouseleave=t=>{s.style.display||t.toElement?.hC("op")||s.hide()},this.on(e)},I(t,e,s){let i=El("div","ip").tx(t),o=i.ap(El("input"));return s&&(o.style.width=s+"px"),i.set=t=>i.v="number"===o.type?Number(o.value=t):o.value=t,"~"!==t&&"×"!==t||(i.style.marginLeft="-5px",o.style.marginLeft="1px"),e&&(o.s=1,Object.assign(o,e),o.m||o.M?(o.type="number",o.step=.01,o.sf=o.s<.1?2:o.s<1?1:0,o.onmouseout=()=>UI.tip._h(),o.onchange=function(){let t=Number(this.value);isNaN(t)||(void 0!==this.m&&t<this.m&&(t=this.m),void 0!==this.M&&t>this.M&&(t=this.M),t=Math.round(t/this.s)*this.s,this.value=t.toFixed(this.sf))},o.onmouseover=function(){let{left:t,top:e}=this.getBoundingClientRect();UI.showTips(this.m.toFixed(this.sf)+"~"+this.M.toFixed(this.sf),0|t,e-24|0)}):o.l&&(o.oninput=function(){this.value.length>this.l&&(this.value=this.value.slice(0,this.l))}),o.w&&(o.ww=0),i.v="number"===o.type?Number(o.value):o.value),o.onwheel=function(t){if(t.preventDefault(),this.w&&document.activeElement===this){let e=Math.floor((Number(this.value)+1e-5)/this.w);t.deltaY<0?++e:Math.abs(this.value-e*this.w)<1e-5&&--e;let s=e*this.w;if(s<this.m||s>this.M)return;this.value=s,clearTimeout(this.wt);let i=new Event("change");this.ww>0&&(i.sk=233),this.dispatchEvent(i),this.wt=setTimeout(t=>t.ww=0,this.ww=1e3,this)}},o.addEventListener("change",t=>i.f(i.v="number"===o.type?Number(o.value):o.value,t.sk)),this.on(i)},Bar(t=200,e=0,s=1,i=0,o){let n=El("div",i?"rg v":"rg"),a=n.ap(El("div","rgb"));return css(n,{[i?"height":"width"]:t+8+"px"}),a.onmousedown=t=>{a.d=!0,a.x=i?t.y/doc.zoom-a.offsetTop:t.x/doc.zoom-a.offsetLeft},n.onmousemove=e=>{if(a.d){let o=i?t-e.y/doc.zoom+a.x:e.x/doc.zoom-a.x;n.set(Math.mM(o/t,0,1),s),n.fin(n.v)}},n.onmouseleave=n.onmouseup=()=>{a.d&&(a.d=!1,n.f?.(n.v))},n.set=(e,s=1)=>{n.v=e,s&&(i?(a.style.top=(1-e)*t+"px",o&&(n.style.backgroundImage=`linear-gradient(0deg,${o} ${e*t}px,#0000 0)`)):(a.style.left=e*t+"px",o&&(n.style.backgroundImage=`linear-gradient(90deg,${o} ${e*t}px,#0000 0)`)))},n.set(e),n.in=t=>(n.fin=t,n),this.on(n)},R(t,e,s,i,o,n){let a=El("div").tx(t);a.m=e,a.M=s,a.r=s-e,a.d=i,a.v=i;let l=a.ap(UI.Bar(200,(i-e)/a.r,0,0,n)).in(t=>a.set(Math.round(t*a.r+a.m))).on(()=>a.f(a.v)),r=a.ap(El("input")),p=a.ap(El("div","reset",{innerHTML:UI.ico("undo")}));return o&&a.aC("ib"),r.value=i,p.onclick=()=>{a.v!=i&&(a.set(i),a.f(i))},a.set=(t=a.d)=>{t=""===t?a.d:Number(t),r.value=a.v=t,l.set((t-a.m)/a.r)},r.onchange=()=>{let t=Number(r.value);isNaN(t)||(a.set(Math.round(Math.mM(t,a.m,a.M))),a.f(a.v))},this.on(a)},ipc:doc.body.ap(El("input",0,{id:"UIipc",type:"color",val(t){t.length<7&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]),this.value=t}})),Col(t,e){let s=El("div","ip").tx(t),i=s.ap(El("div","col"));return i.style.background=s.v=e||"#fff",s.c=t=>{if("#"!==t[0]){const e=t.match(/\d+/g);t=((e[0]<<16)+(e[1]<<8)+(0|e[2])).toString(16).padStart(7,"#000000")}return t[1]===t[2]&&t[3]===t[4]&&t[5]===t[6]&&(t="#"+t[1]+t[3]+t[5]),t},i.onclick=t=>{css(UI.ipc,{left:t.x/doc.zoom+"px",top:t.y/doc.zoom+"px"}),UI.ipc.onchange=()=>{let t=s.c(UI.ipc.value);i.style.background=s.v=t,s.f(t)},UI.ipc.val(s.c(i.style.background)),$M.task(()=>UI.ipc.click())},s.set=t=>i.style.background=s.v=t,this.on(s)},P:(t,e,s,i)=>new Promise((o,n)=>{UI.file("image/*","DataURL").then(a=>{let l=new Image;l.onload=()=>{if(l.width<t)return UI.$a("0{2r}"+t),n();if(l.height<e)return UI.$a("0{2s}"+e),n();let a=l.width,r=l.height;for(;a>960||r>640;)a>>=1,r>>=1;let p=El("canvas","ab",{width:a,height:r}),c=El("canvas","ab",{width:t,height:e}),h=new UI.M(a+t+16,Math.max(r,e+100)+48).h(s).ap(p).ap(c).b("确定","取消");h.then(t=>{if(!t.i){let t,e=c.toDataURL("image/png");t=e.length>=10240?c.toDataURL("image/webp"):c.toDataURL("image/webp",1),o(t.length<e.length?t:e)}}),css(p,{left:"16px",top:"64px"}),css(c,{right:"16px",top:"64px"}),i&&(c.style.borderRadius="100%"),css(h.box.lastChild,{position:"absolute",left:a+16+"px",right:0,top:e+72+"px"});let d=p.getContext("2d"),u=c.getContext("2d");d.imageSmoothingQuality=u.imageSmoothingQuality="high",d.fillStyle="#000",d.fillRect(0,0,a,r),d.drawImage(l,0,0,a,r);let f=Math.min(a,r/e*t),m=Math.min(r,a/t*e),g=a-f>>1,v=r-m>>1,b=a-g-f,x=r-v-m,I=El("div","ab"),U=I.ap(El("div","ab"));h.ap(I),css(I,{left:"16px",top:"64px",width:a+"px",height:r+"px",overflow:"hidden"}),css(U,{left:g+"px",top:v+"px",right:b+"px",bottom:x+"px",border:"2px solid #fc0",outline:"960px solid #0007"}),U.L=g,U.T=v,U.R=b,U.B=x,U.mouse=function(t,e){let{left:s,top:i,right:o,bottom:n}=this.getBoundingClientRect(),a=t<s+16|(t>o-16)<<1|(e<i+16)<<2|(e>n-16)<<3,l="move";switch(a){case 5:case 10:l="nwse-resize";break;case 9:case 6:l="nesw-resize"}return this.style.cursor=l,a+1},U.draw=()=>u.drawImage(p,U.L,U.T,a-U.R-U.L,r-U.B-U.T,0,0,t,e),U.draw(),U.onmousedown=t=>U.drag=U.mouse(t.x/doc.zoom,t.y/doc.zoom),I.onmouseup=I.onmouseleave=()=>{U.drag=0,I.style.cursor="",U.draw()},I.onmousemove=s=>{if(U.drag&&1===s.buttons){let i=s.movementX,o=s.movementY,n=U.drag-1;switch(n){case 5:case 10:case 9:case 6:o=Math.abs(i)/t*e*(9===n||6===n?-Math.sign(i):Math.sign(i)),4&n?o<-U.T&&(o=-U.T):8&n&&o>U.B&&(o=U.B),i=Math.abs(o)/e*t*Math.sign(i),1&n?(i<-U.L&&(i=-U.L),U.L+=i):2&n&&(i>U.R&&(i=U.R),U.R-=i),a-U.R-U.L<t&&(1&n?U.L=a-U.R-t:U.R=a-U.L-t),4&n?U.T=r-U.B-(a-U.R-U.L)/t*e:U.B=r-U.T-(a-U.R-U.L)/t*e;break;default:i>U.R&&(i=U.R),i<-U.L&&(i=-U.L),o>U.B&&(o=U.B),o<-U.T&&(o=-U.T),U.L+=i,U.R-=i,U.T+=o,U.B-=o}css(U,{left:U.L+"px",top:U.T+"px",right:U.R+"px",bottom:U.B+"px"}),I.style.cursor=U.style.cursor}},U.onmousemove=function(t){this.drag||this.mouse(t.x/doc.zoom,t.y/doc.zoom)}},l.src=a[0]})}),LB(t,e){let s=El("table","LB"),i=s.ap(El("thead")).ap(El("tr")),o=s.ap(El("tbody")),n=[];return i.ap(El("th").tx("#")),t.for(t=>{i.ap(El("th").tx(t.n)),t.c}),e.for(e=>{let s=El("tr");s.d=e,n.push(s),s.ap(El("td")),t.for(t=>{let i=s.ap(El("td")),o=t.v(e);"object"==typeof o?i.ap(o):i.tx(o)})}),s.sort=(e,s=!1)=>{n.sort((i,o)=>s?t[e].s(o.d,i.d):t[e].s(i.d,o.d)),n.for(t=>o.append(t))},s.sort(t.findIndex(t=>t.s)),s},Play(t=!1){let e=El("div","m-play");return t&&e.aC("btn2"),e.v=0,e.onclick=()=>{e.v=1-e.v,e.v?e.aC("p"):e.rC("p"),e.f(e.v)},this.on(e)}};"/"===location.pathname||"/update"===location.pathname||location.pathname.startsWith("/runner")||doc.fonts.ready.then(()=>{const t=UI.menu;for(let e=4;e--;)t.ap(El("div","menu"));UI.menu.ap(El("div"));let e=t.ch;e[0].innerHTML=UI.ico("home")+"<p>0{9}</p>",e[1].innerHTML=UI.ico("set")+"<p>0{a}</p>",e[2].innerHTML=UI.ico("help")+"<p>0{b}</p>",e[3].innerHTML=UI.ico("exit")+"<p>0{c}</p>",e[0].onclick=()=>{Ipc.beforeClose?.(),Ipc.closeMsg?UI.$q(Ipc.closeMsg,1).then(t=>{t.i||LOC("home")}):LOC("home")},e[1].onclick=()=>{e[4]._s(),$M.task(()=>css($("setting"),{opacity:1,transform:"translate(-50%,-50%) scale(1.25)"})),$c("setcat",e[4])[0].click()},e[2].onclick=()=>App.help(),e[3].onclick=()=>Ipc.close(0),e[4].id="setting",e[4].innerHTML=`<h3>${UI.ico("set")} 0{a}</h3>`,e[4].ap(El("div","msg-cb")).onclick=()=>{css(e[4],{opacity:0,transform:""}),setTimeout(()=>$("setting")._h(),200)},["0{2t}","0{2u}","0{2v}","0{l}"].for(t=>{e[4].ap(El("div","setcat").tx(t),El("div","setpage"))}),UI.bindCat(e[4]);let s=$c("setpage",e[4]);s[0].ap(UI.span("0{2w}"),UI.O("中文:zh-cn","English:en-us").on(t=>{const e=t=>{t!==_lang&&($S.set("lang",t),UI.$q("0{2x}",1).then(t=>{t.i||Ipc.send("relaunch")}))};if("zh-cn"===t)return e(t);Local.get("f",t+".json").then(s=>{try{JSON.parse(s.t),e(t)}catch{UI.$a("0{2y}",1)}})}),El("br"),UI.span(" "),UI.B("0{2z}",1).on(t=>{t.set(),App.chkUpd(e=>{1===e?LOC("update"):0===e&&UI.$a("0{30}",1),t.set(1)},e=>{UI.$a("0{31}",1),console.error(e),t.set(1)})}),El("br"),UI.span("错误调试 "),UI.B("查看错误日志",1).on(()=>Ipc.send("log")),UI.span(" "),UI.B("查看图形功能状态",1).on(()=>{Ipc.f.gfs=t=>{const e={Canvas:t["2d_canvas"],Compositing:t.gpu_compositing,Rasterization:t.rasterization,WebGL:t.webgl2};let s="";for(let t in e)s+=`<p>${t}: <span style='color:#`,e[t].startsWith("enabled")&&"enabled_force"!==e[t]?s+="0a0":s+="e22",s+=`;'>${e[t]}</span></p>`;new UI.M(0,0,1).h("图形功能状态").cb().a(s)},Ipc.send("gfs")})),s[1].id="set-ui",s[1].ap(UI.S("0{32} (F3) ").on(t=>App.setDarkMode(t)),UI.S("0{33} (F4) ").on(()=>App.setFscr()),UI.span("0{34} (F5)"),UI.O("1280x720:0.8889","1440x810:1","1920x1080:1.3334","2880x1620:2").on(t=>App.setWinSc(t)));const i=t=>(t/(1<<20)).toFixed(2);s[2].ap(UI.span("0{35}0 MB"),UI.help("0{36}",1),UI.p("","10px 0 7px 0"),UI.span("- 0{37}0 MB "),UI.B("0{38}",1).on(t=>{t.set(),UI.$q("0{39}",1).then(e=>{e.i||Ipc.send("clear"),t.set(1)})})),[["0{3a}","avatar",1],["0{3b}","cover",1],["0{3c}","bgm",1],["0{3d}","img"],["0{3e}","snd"],["0{3f}","font"]].for(t=>{let e=UI.span(" ");e.aC("storage"),e.set=()=>{let s=App.stor[t[1]]??0;e.tx(`- ${t[0]}：${i(s)} MB`),e.nS().set(s&&t[2])},s[2].ap(El("br"),e,UI.B("0{38}",1).on(e=>{e.set(),CIW.clear(t[1]).then(()=>e.pS().set()).catch(()=>UI.$a("0{3g}",1).then(()=>e.set(1)))}))}),s[3].ap(UI.C("0{3h} ",0,60,30).on(t=>App.sC("run","fps",2===t?30:60)),UI.S("0{3i}").on(t=>App.sC("run","smooth",t))),s[0].set=function(){let t=this.ch;t[1].set(_lang),t[3].tx("0{3j}"+$S.get("version"))},s[1].set=function(){let t=this.ch,e=App._sc||1;t[0].set(doc.body.className),t[1].set(App._fscr),t[3].set(e)},s[2].set=function(){let t=this.ch;Ipc.cache(e=>{navigator.storage.estimate().then(s=>t[0].tx("0{35}"+i(e+s.usage)+" MB")),t[3].tx("- 0{37}"+i(e)+" MB")}),t[2].tx("- 0{3k}"+i(App.stor.app??0)+" MB"),$c("storage",this).for(t=>t.set())},s[3].set=function(){let t=this.ch;t[0]._h(),t[1].set(App.gC("run","smooth"))},location.pathname.match(/login|home/)&&e[0]._h()}),doc.addEventListener("keydown",t=>{if(t.repeat||t.altKey)return;const e=!location.pathname.startsWith("/runner");switch(t.keyCode){case 114:App.setDarkMode(!doc.body.className,e);break;case 115:App.setFscr(e);break;case 116:let t=e?[1.3334,2,.8889,1]:[1.5,2,1];App.setWinSc(t[(t.findIndex(t=>t==App._sc)+1)%4],e);break;case 27:"/"!==location.pathname&&"/update"!==location.pathname&&(UI.menu.on?UI.hideMenu():UI.showMenu())}});