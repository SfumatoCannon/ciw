$E.pro={clipBoard:[],noAddP:["dep","scx","scy","ang","a","ti"],addFold(i){let t=i.ch[1];t.style.cursor="pointer",t.onclick=()=>{i.hC("fold")?i.rC("fold"):i.aC("fold"),$E.fixH($c("cat")[18])}},actInd(i){return i===i<<0?this.acLib[1][i]:this.acLib[4+i|0][Math.round(100*i%100-1)]},conInd(i){return this.acLib[11+i|0][Math.round(100*i%100-1)]},chkPro(i,t){switch(t){case"mov":let d=i.add[t];for(let t=d.length;t--;){let o=this.acLib[1][d[t][0]];o.c&&o.c&i.lib&&d.splice(t,1)}break;case"tml":i.add[t].for(t=>{let d=t[1];for(let t=d.length;t--;){let o=this.actInd(d[t][0]);o.c&&o.c&i.lib&&d.splice(t,1)}});break;case"trg":let o=i.add[t];for(let t=o.length;t--;){let d=o[t];d[2].for(d=>{let n=this.conInd(d[0]);n.c&&n.c&i.lib&&o.splice(t,1)});let n=d[3];for(let t=n.length;t--;){let d=this.actInd(n[t][0]);d.c&&d.c&i.lib&&n.splice(t,1)}}}},applyPro(i,t,d){if($E.C._U(),0===i){for(let i in t){if("mov"===i||"tml"===i||"trg"===i||"gid"===i||"gpi"===i)continue;if("til"===i){d.for(d=>{d.tile&&(d.ti=[t[i]/1e3|0,t[i]%1e3])});continue}let o=this.acLib[0].find(t=>t.p.includes(i));if(!o)return;d.for(d=>{if(0!==d.ind&&!(o.apl?.some(i=>void 0===d.add[i])||o.c&&o.c&d.lib))if(this.noAddP.includes(i))if(d.autoTile){let o=d.R[0],n=d.LT[1],{w:e,h:c}=d;d[i]=t[i],$E.E.rTile(o,n,e,c,d)}else d[i]=t[i];else d.add[i]=t[i]})}$E.sfO.redraw()}else{let o=["mov","tml","trg"][i-1];d.for(i=>{0!==i.ind&&(i.add[o]=$M.cp(t),this.chkPro(i,o))})}},updTml(i,t,d){if(!i)return;const o=d?[4.04]:[4.01,4.02,4.03];i.for(i=>{i.at(-1).for(i=>{o.includes(i[0])&&i[1]>t&&(i[1]--,i.set())})})},CV(i,t,d){let o=El("div","ab");css(o,{top:t+"px",right:"28px"});let n=El("div","p-btn",{innerHTML:UI.ico("copy")+"<div>0{91}</div>"}),e=El("div","p-btn",{innerHTML:UI.ico("paste")+"<div>0{92}</div>"});return n.onclick=()=>this.clipBoard[i]=JSON.stringify(o.pN.pro),e.onclick=()=>{if(this.clipBoard[i]){let t=JSON.parse(this.clipBoard[i]);d&&!d(t)||($E.C._U(),t.for((i,t)=>o.pN.pro[t]=i),$E.reloadPro())}},o.ap(n,e),o},apAc(i,t,d,o,n=!0,e){let c=El("div","p-ac"),p=d.pn??d.p,l=d.n.replace("\n","<br/>");switch(c.p=d.p,c._id=d.type+d.ind+t.i+d.p?.join(),e?o.before(c):o.ap(c),d.type){case"tml":c.aC("tml");case"trg":l+=t.i,t.set=()=>c.ch[1].tx(d.n+t.i)}c.pro=t,c.innerHTML=`${UI.ico(d.ico)}<span>${l}</span>`;const r=$E.C,a=233;if(n&&(c.innerHTML+="<svg class='p-del'><use href='#-trash'></use></svg>",c.lastChild.onclick=()=>{if(r._U(),Array.isArray(i)){let o=t.i;i.splice(o,1);for(let t=o;t<i.length;t++)i[t].i=t,"tml"===d.type||"trg"===d.type?i[t].set():(.02===i[t][0]&&i[t][1]>o&&(i[t][1]--,i[t].set()),i[t].check?.());"tml"===d.type?(this.updTml(i,o),this.updTml($E.$O[0].add.trg,o)):"trg"===d.type&&(this.updTml(i,o,1),this.updTml($E.$O[0].add.tml,o,1))}else if(i.R){let[o,n]=i.LT,{w:e,h:c}=i;d.p.for(d=>{i[d]=void 0,delete i[d],delete t[d]}),d.calc&&i.calcRect(),d.d&&(i.autoTile&&$E.E.rTile(o,n,e,c,i),$E.sfO.$d(o,n,e,c),$E.sfO.$d(i.R[0],i.LT[1],i.w,i.h),$E.sfO.update(),$E.C.dM(0,0,1))}else d.p.for(i=>{delete t[i]}),d.d&&i.drawTxt?.(1);c.remove(),$E.fixH($c("cat")[18])}),d.copy)switch(d.copy){case"tml":c.ap(this.CV("tml",2,i=>{let t=$E.$O[0],d=i[1];for(let i=d.length;i--;){let o=this.actInd(d[i][0]);if(o.c&&o.c&t.lib)return}return 1}));break;case"trg":c.ap(this.CV("trg",2,i=>{let t=$E.$O[0],d=i[2];for(let i of d){let d=this.conInd(i[0]);if(d.c&&d.c&t.lib)return}let o=i[3];for(let i=o.length;i--;){let d=this.actInd(o[i][0]);if(d.c&&d.c&t.lib)return}return 1}))}if("trg"===d.type&&c.ap(El("br")),d.p&&d.p.for((o,n)=>{if(d.t[n].n)c.ap(UI.B2(d.t[n].n)).on(i=>{$E.inEdit?$E.exitEdit():$E.setEdit(i,d.t[n].click,d.t[n].move,d.t[n].draw)});else if(d.t[n].includes("|")){let e=d.t[n].split("|"),l=[],s=[];e.for((n,e)=>{let c=n.split("<"),p=c[1].split(","),h=El("div","ib");l.push(c[0]),s.push(h),t[o]?.[0]!==e&&h._h(),p.for((n,e)=>{let c=n.split(">"),p=c[1].split(":");switch(c=c[0],p[0]){case"i":let n=p[1].split("*"),l=n[1]??1,s=n[0].split("+"),f=s[0].split("~");s=s[1].split("-"),h.ap(UI.I(c,{type:"number",value:t[o]?.[e+1]??s[1]??0,m:Number(f[0]),M:Number(f[1]),s:Number(s[0]),w:Number(l)},36).on((d,n)=>{n!==a&&r._U(),t[o][e+1]=d,10===i.ind&&i.pG()}));break;case"t":h.ap(UI.I(c,{value:t[o]?.[e+1]??"00000000"},80).on((n,c)=>{c!==a&&r._U();let p=t[o];p[e+1]=n,t[o]=p,d.d&&($E.sfO.$d(i.R[0],i.LT[1],i.w,i.h),$E.sfO.update())}))}})});let h=UI.O(...l).on((n,e)=>{e!==a&&r._U(),n=Number(n),s.for((i,t)=>n==t?i._s():i._h());let c=[n];for(let i of s[n].ch)c.push(i.v);return t[o]=c,d.d&&(10===i.ind?i.pG():($E.sfO.$d(i.R[0],i.LT[1],i.w,i.h),$E.sfO.update())),n}),f=c.ap(El("div","rl"));"ti"!==o&&.01!==d.ind||f.aC("ib"),f.ap(UI.span(p[n]),h),h.set(t[o]?.[0]??h.f(0,a)),s.for(i=>f.ap(i))}else if(Array.isArray(d.t[n])){let e=UI.O(...d.t[n]).on((n,e)=>{e!==a&&r._U();let c=Number(n);if(n=isNaN(c)?n:c,this.noAddP.includes(o)){let t=i.R[0],d=i.LT[1],{w:e,h:c}=i;i[o]=n,i.autoTile&&$E.E.rTile(t,d,e,c,i),$E.sfO.$d(t,d,e,c),$E.C.dM(0,0,1),"a"===o&&($("edit-x")?.set($E.$O[0].x),$("edit-y")?.set($E.$O[0].y))}else t[o]=n;d.d&&(i.svg?i.drawTxt():($E.sfO.$d(i.R[0],i.LT[1],i.w,i.h),$E.sfO.update())),5.01===d.ind&&n.length&&Au.play(n,2**((t[o+1]??0)/12))});e.set(t[o]??e.f(0,a)),c.ap(UI.span(p[n]),e),d.t[n]===this.acAO?(css(e,{minWidth:0,float:"right",marginRight:"8px"}),css($c("op",e.m),{minWidth:0})):"="===d.t[n][0]&&(css(e,{minWidth:0,width:"16px",margin:0}),css($c("op",e.m),{minWidth:0}))}else{let e=d.t[n].split(":");switch(e[0]){case"i":let l=e[1].split("*"),s=l[1]??1,h=l[0].split("+"),f=h[0].split("~"),b=p[n];h=h[1].split("-"),"\n"===b.at(-1)&&(b=b.slice(0,-1));let E=c.ap(UI.I(b?b+":":"",{type:"number",value:t[o]??(Array.isArray(i)?h[1]??0:i[o]??h[1]??0),m:Number(f[0]),M:Number(f[1]),s:Number(h[0]),w:Number(s)},36)).on((n,e)=>{if("x"===o||"y"===o){if(i.gO()?.add.gpm[0])return;10===i.ind&&i.mG(o,n)}e!==a&&r._U();let c=i.R?.[0],p=i.LT?.[1],{w:l,h:s}=i;this.noAddP.includes(o)||"x"===o||"y"===o?i[o]=Number(n):t[o]=Number(n),d.calc&&i.calcRect(),d.d&&i.w&&(i.autoTile&&$E.E.rTile(c,p,l,s,i),$E.sfO.$d(c,p,l,s),$E.C.dM(0,0,1),i.svg?i.drawTxt():($E.sfO.$d(i.R[0],i.LT[1],i.w,i.h),$E.sfO.update())),t.check?.(),5.01===d.ind&&t[o-1].length&&Au.play(t[o-1],2**(t[o]/12))});if(E.id="edit-"+o+(d.ind??""),0===n)switch(d.ind){case.02:case 4.01:case 4.02:case 4.03:case 4.04:t.set=()=>E.set(t[1])}else.02===d.ind&&(t.check=()=>{if(0===t[2]){for(let d=t[1];d<=t.i;d++)if(.01===i[d][0])return;E.f(E.set(1)),UI.$a(`0{bk}${t[1]}-${t.i}0{bl}`)}});void 0===t[o]&&"x"!==o&&"y"!==o&&E.f(h[1]??0,a),"\n"===p[n].at(-1)&&c.ap(El("br"));break;case"s":case"s1":c.ap(UI.S(p[n]+":",t[o]??"s1"===e[0]).on((n,e)=>{e!==a&&r._U(),t[o]=n,d.d&&i.w&&($E.sfO.$d(i.R[0],i.LT[1],i.w,i.h),$E.sfO.update())})).style.display="inline-block",void 0===t[o]&&c.lastChild.f("s1"===e[0]?1:0,a);break;case"c":c.ap(UI.Col(p[n]+":",t[o])).on(n=>{r._U(),t[o]=n,d.d&&i.svg&&i.drawTxt()});break;case"txt":c.ap(El("br"));let m=c.ap(El`textarea`);m.value=i[o]??i.add[o],m.onchange=()=>{r._U(),i[o]=m.value}}}}),"tml"===d.type){this.addFold(c),c.style.paddingBottom="28px",c.aC("count");let i=El("div","p-add",{innerHTML:UI.ico("add")+"0{bm}"});i.obj=t[1],c.ap(i).onclick=function(){$E.pro.acChs.set(this,4,this.obj)}}else if("trg"===d.type){this.addFold(c);let i=c.ap(El("div","p-ac trg",{innerHTML:UI.ico("if")+"0{bn}"})),d=c.ap(El("div","p-ac",{innerHTML:UI.ico("act")+"0{bo}"})),o=i.ap(El("div","p-add",{innerHTML:UI.ico("add")+"0{bp}"})),n=d.ap(El("div","p-add",{innerHTML:UI.ico("add")+"0{bq}"}));css([i,d],{paddingBottom:"28px"}),d.style.borderBottom="none",o.obj=t[2],n.obj=t[3],o.onclick=function(){$E.pro.acChs.set(this,5,this.obj)},n.onclick=function(){$E.pro.acChs.set(this,6,this.obj)}}return c.pN.hC("tml")&&(c.ap(El("div","tml-add")).onclick=function(){$E.pro.acChs.set(this,4,i)}),$E.fixH($c("cat")[18]),c},initLib(){const i="i:-32~4032+1*16",t="i:1~6000+1-1",d="0{br}<>i:0.1~128+0.1-4|0{bs}<>i:0.1~128+0.1-2,~>i:0.1~128+0.1-4",o="0{br}<>i:-128~128+0.1|0{bs}<>i:-128~128+0.1,~>i:-128~128+0.1",n="0{br}<>i:0~359+1*15|0{bs}<>i:-360~360+1*15,~>i:-360~360+1-360*15|0{bt}<>i:0~359+1-0*90|0{bu}<>|0{bv}<>",e=[1],c=[1,2],p=[1,2,3],l=[1,2,3,4],r=["0{bw}","0{bx}"],a=["=",">","<","≥","≤","≠"],s=["0{7p}:L","0{by}:R","0{7q}:U","0{bz}:D","0{c0}(Shift):J","0{9j}(Z):z","W:w","A:a","S:s","D:d","X:x"],h=["0{c1}","0{c2}"],f=["0{b9}","0{c3}","0{c4}","0{5g}","0{17}","0{5i}",["0{v}",...Lib._o.slice(1).map((i,t)=>i.n+":"+(t+6))]],b=[[["0{c5}"],["0{c6}"]],"i:12~128+1",["1{2o}","0{c7}","0{c8}","0{c9}"],["0{ca}","0{cb}","0{cc}"],"c","i:0~8+1","c","i:0~16+1","c"],E=()=>{let i=$E.$O[0],t=$E.sfE;t.clear(),i.dInfo(),t.strokeStyle="#000",$E.C.dSelect(i.R[0],i.LT[1],i.w,i.h)},m=()=>{let i=$E.C,t=$E.$O[0],d=$E.C.colPosObj(i.mTX,i.mTY);if(!d||0===d.ind)return;let o=t.add.gid;0===i.mB?d.cG(t)||d.add.gpi?.startsWith(o)||($E.C._U(),t.group(d),E()):2===i.mB&&d.add.gpi?.startsWith(o)&&($E.C._U(),delete d.add.gpi,10!==d.ind&&(d.dInfo=null),E())};Res.fontList.forEach((i,t)=>{i[1]>3?b[0][0].push(i[2]+":"+t):b[0][1].push(i[0]+":"+t)}),b[0][1].sort((i,t)=>i.localeCompare(t)),this.acAO=r,this.acLib=[[{n:"0{cd}",ico:"position",p:["x","y"],t:[i,"i:-32~3072+1*16"],d:1,h:1},{n:"0{1j}",ico:"layer",p:["dep"],pn:["0{ce}"],t:["i:0~11+1-7"],d:1,del:0,c:16},{n:"0{cf}",ico:"col",p:["cm"],pn:[""],t:[["无碰撞","一般物体","固体","板子","致命","水"]],del:0,c:1},{n:"0{cg}",ico:"rotate",p:["a"],pn:[""],t:[["图像原点","左上","中上","右上","左中:5","中心:6","右中:7","左下:9","中下:10","右下:11"]],d:1,c:34},{n:"0{ch}",ico:"resize",p:["w","h"],pn:["0{7a}","0{7b}"],t:["i:16~800+1-32*16","i:16~608+1-32*16"],apl:["w"],d:1,calc:1,del:0},{n:"0{ci}",ico:"resize",p:["scx","scy"],pn:["x","y"],t:["i:-25~25+0.01-1","i:-25~25+0.01-1"],d:1,c:2},{n:"0{af}",ico:"ang",p:["ang"],pn:[""],t:["i:0~359+1-0*15"],d:1,c:2},{n:"显示",ico:"see",p:["hd"],pn:[""],t:[["可见","不可见"]],d:1},{n:"0{cj}",ico:"see",p:["al"],pn:["alpha"],t:["i:0~1+0.01-1*0.1"],d:1,c:2},{n:"0{69}",ico:"text",p:["txt"],t:["txt"],apl:["txt"],del:0},{n:"0{ck}",ico:"label",p:["ftf","fts","ftt","fta","ftc","fst","fkc","fsd","fsc"],pn:["","0{ch}\n","0{cl}","0{cm}","0{ar}","0{cn}","0{ar}","0{co}","0{ar}"],t:b,apl:["ftf"],d:1,del:0},{n:"传送",ico:"warp",p:["wr","ws","wx","wy"],pn:["房间"," 效果","位置(为0则使用出生点位置) x","y"],t:[["下一房间:128","当前房间:0",["指定房间",()=>$E._R.map(i=>i.name+":"+(i.id-$E._r.id))]],["淡入淡出","无效果","传送效果","旋转矩形","Kid形状"],"i:0~4000+1","i:0~3040+1"],apl:["ws"],del:0},{n:"长度",ico:"len",p:["len"],pn:[""],t:["i:32~800+1-32*16"],apl:["len"],d:1,del:0},{n:"激光状态",ico:"label",p:["lso"],pn:["开启激光"],t:["s"],apl:["lso"],del:0},{n:"激光属性",ico:"label",p:["lst"],pn:["穿透固体"],t:["s"],apl:["lst"],del:0},{n:"摩擦力",ico:"label",p:["frc"],pn:[""],t:["i:0.1~1+0.1-0.1"],apl:["frc"],del:0},{n:"数量",ico:"label",p:["num"],pn:[""],t:["i:2~72+1-4"],apl:["num"],d:1,del:0},{n:"贴图",ico:"label",p:["ti"],pn:[""],t:["自动贴图<>|手动贴图<贴图编码>t"],apl:["til"],d:1,del:0,h:1},{n:"传送速度",ico:"acc",p:["csp"],pn:[""],t:["i:1~32+1-3"],apl:["csp"],del:0},{n:"组合物体",ico:"if",p:["gid","gpm"],pn:["",""],t:[{n:"选择组合物体",click:m,move(i,t){t.drag&&m()},draw:E},"自由组合<>|圆形组合<数量>i:1~100+1-8,半径>i:0~512+1-96*16|多边形组合<边>i:3~8+1-4,半径>i:0~512+1-96*16,数量>i:1~16+1-3"],apl:["gpm"],d:1,del:0},{n:"组合控制\n",ico:"if",p:["csc","cag","cds"],pn:["控制缩放","控制角度","控制销毁"],t:["s","s","s","s"],apl:["csc"],del:0},{n:"跳跃段数",ico:"ply",p:["jump","sJump"],pn:["(-1为无限跳)","存档保存"],t:["i:-1~10+1-2","s"],apl:["sJump"],del:0},{n:"重力方向",ico:"ply",p:["g_","sGravDir"],pn:["","存档保存"],t:[["向下:270","向上:90","向左:180","向右:0"],"s"],apl:["g_"],del:0},{n:"子弹连发",ico:"ply",p:["conShoot"],pn:[""],t:["s"],apl:["conShoot"],del:0},{n:"AD位移",ico:"ply",p:["adMove"],pn:[""],t:["s"],apl:["adMove"],del:0},{n:"生命值",ico:"ply",p:["life"],pn:[""],t:["i:1~10+1-1"],apl:["life"],del:0},{n:"文本",ico:"text",p:["txt1","ftf1","fts1","ftt1","fta1","ftc1","fst1","fkc1","fsd1","fsc1"],pn:["","字体","大小\n","样式","对齐","颜色","描边","颜色","发光","颜色"],t:["txt",...b],apl:["txt1"],d:1,del:0},{n:"提示文本",ico:"text",p:["txt2","ftf2","fts2","ftt2","fta2","ftc2","fst2","fkc2","fsd2","fsc2"],pn:["","字体","大小\n","样式","对齐","颜色","描边","颜色","发光","颜色"],t:["txt",...b],apl:["txt2"],d:1,del:0}],[{n:"移动到位置",ico:"move",ind:0,p:l,pn:["x","y","速度","速度模式"],t:["相对位置<>i:-999~999+1*32|绝对位置<>i:-32~4032+1*32","相对位置<>i:-999~999+1*32|绝对位置<>i:-32~3072+1*32",d,["匀速","减速"]],c:2},{n:"移动距离",ico:"move",ind:1,p:l,pn:["距离","方向","速度","速度模式"],t:["i:1~999+1-32*32",n,d,["匀速","减速"]],c:2},{n:"水平+竖直速度",ico:"move",ind:2,p:c,pn:["水平速度","竖直速度"],t:[o,o],c:2},{n:"速度+方向",ico:"move",ind:3,p:c,pn:["速度","方向"],t:[d,n],c:2},{n:"加速度",ico:"acc",ind:4,p:c,pn:["大小","方向"],t:["i:0.01~1+0.01-0.2","i:0~359+1-270*90"],c:2},{n:"角度控制",ico:"ang",ind:5,p:e,pn:["角度"],t:["与运动方向夹角<>i:0~359+1-0*90|与指向玩家方向夹角<>i:0~359+1-0*90"],c:2},{n:"旋转",ico:"rotate",ind:6,p:e,pn:["旋转速度"],t:["固定值<>i:-180~180+0.1-1|随机值<>i:-180~180+0.1,~>i:-180~180+0.1"],c:2},{n:"摆动",ico:"swing",ind:7,p,pn:["初始角","幅度","周期"],t:["i:0~359+1","i:1~180+1-30","i:4~1000+1-100"],c:2},{n:"水平简谐运动\n",ico:"sin",ind:8,p,pn:["振幅","周期","初相"],t:["i:1~800+1-32*16","i:4~1000+1-100","i:0~359+1-0*90"],c:2},{n:"竖直简谐运动\n",ico:"sin",ind:9,p,pn:["振幅","周期","初相"],t:["i:1~608+1-32*16","i:4~1000+1-100","i:0~359+1-0*90"],c:2},{n:"路径",ico:"path",ind:10,p:["pth"],pn:[""],t:[{n:"编辑路径"}],c:2},{n:"跟随玩家",ico:"aim",ind:11,p:e,pn:["速度"],t:["i:0.1~32+0.1-1"],c:10},{n:"同步玩家",ico:"aim",ind:12,p:l,pn:["同步x","偏移量","同步y","偏移量"],t:["s","i:-800~800+1-0*32","s","i:-800~800+1-0*32"],c:10},{n:"运动障碍",ico:"stop",ind:13,p:c,pn:["","效果"],t:[["固体","板子","致命","水",["物体",...Lib._o.slice(1).map((i,t)=>i.n+":"+(t+4))]],["阻挡","反弹"]],c:3}],[{n:"0{cp}",ico:"timer",type:"tml",copy:"tml",p:[0],pn:["直接运行"],t:["s1"]}],[{n:"0{cq}",ico:"logic",type:"trg",copy:"trg",p:[0,1],pn:["执行顺序","执行次数(0=无限)"],t:[["时间轴前","移动前","移动后","手动执行"],"i:0~999+1-1"]}],[{n:"间隔",ico:"timer",ind:.01,p:e,pn:[""],t:["帧数<>i:1~6000+1-50|节拍数<>i:1~999+1-1"]},{n:"循环",ico:"redo",ind:.02,p:c,pn:["节点","次数(0=无限)"],t:["i:0~999+1-0","i:0~999+1-0"]}],[{n:"碰撞属性",ico:"col",ind:1.01,p:e,pn:[""],t:[["无碰撞","一般物体","固体","板子","致命","水"]],c:1},{n:"0{ci}",ico:"resize",ind:1.02,p,pn:["x","y","过渡时长"],t:["固定值<>i:-25~25+0.01-1|增加值<>i:-5~5+0.01","固定值<>i:-25~25+0.01-1|增加值<>i:-5~5+0.01",t],c:2},{n:"0{af}",ico:"ang",ind:1.03,p:c,pn:["角度","过渡时长"],t:["固定值<>i:0~359+1*15|增加值<>i:-360~360+1*15",t],c:2},{n:"显示",ico:"see",ind:1.04,p:e,pn:[""],t:[["可见","不可见","相反"]]},{n:"透明度",ico:"see",ind:1.05,p:c,pn:["alpha值","过渡时长"],t:["固定值<>i:0~1+0.01-1*0.1|增加值<>i:-1~1+0.01*0.1",t],c:2},{n:"0{cg}",ico:"rotate",ind:1.06,p:e,pn:[""],t:[["图像原点","左上","中上","右上","左中:5","中心:6","右中:7","左下:9","中下:10","右下:11"]],c:32},{n:"长度",ico:"len",ind:1.07,p:c,pn:["长度","过渡时长"],t:["固定值<>i:32~800+1-32*16|增加值<>i:-800~800+1*16",t],apl:["len"]},{n:"激光状态",ico:"label",ind:1.08,p:e,pn:[""],t:[["关闭","开启","相反"]],apl:["lso"]},{n:"激光属性",ico:"label",ind:1.09,p:e,pn:[""],t:[["不穿透固体","穿透固体","相反"]],apl:["lst"]},{n:"位置",ico:"position",ind:1.1,p:c,pn:["x","y"],t:["相对位置<>i:-999~999+1*32|绝对位置<>i:-32~4032+1*32","相对位置<>i:-999~999+1*32|绝对位置<>i:-32~3072+1*32"],c:2},{n:"摩擦力",ico:"label",ind:1.11,p:e,pn:[""],t:["i:0.1~1+0.1-0.1"],apl:["frc"]}],[{n:"停止运动",ico:"stop",ind:2.01,c:2},{n:"改变速度",ico:"acc",ind:2.02,p:e,pn:["速度"],t:["固定值<>i:0.1~128+0.1-4|随机值<>i:0.1~128+0.1-2,~>i:0.1~128+0.1-4|增加值<>i:-128~128+0.1|倍乘值<>i:-5~5+0.01-1"],c:2},{n:"改变水平速度",ico:"acc",ind:2.03,p:e,pn:["水平速度"],t:["固定值<>i:-128~128+0.1|随机值<>i:-128~128+0.1,~>i:-128~128+0.1|增加值<>i:-128~128+0.1|倍乘值<>i:-5~5+0.01-1"],c:2},{n:"改变竖直速度",ico:"acc",ind:2.04,p:e,pn:["竖直速度"],t:["固定值<>i:-128~128+0.1|随机值<>i:-128~128+0.1,~>i:-128~128+0.1|增加值<>i:-128~128+0.1|倍乘值<>i:-5~5+0.01-1"],c:2},{n:"改变方向",ico:"ang",ind:2.05,p:e,pn:["方向"],t:["固定值<>i:0~359+1*15|随机值<>i:-360~360+1*15,~>i:-360~360+1-360*15|指向玩家<>|离开玩家<>|增加值<>i:-179~180+1*15"],c:2}],[{n:"销毁",ico:"trash",ind:3.01,p:e,pn:["效果"],t:[["无","掉落","淡出"]]},{n:"改变子图像",ico:"label",ind:3.02,p:e,pn:[""],t:[["0","1","切换"]],c:16},{n:"设置触发器",ico:"trg",ind:3.03,p:[2,1],pn:["","触发器"],t:[["开启","关闭","切换"],"i:0~999+1-0"]},{n:"改变变量值",ico:"label",ind:3.04,p:c,pn:["变量","值"],t:[[["全局变量",()=>Object.keys($E.GAME.VAR).map(i=>i+":0"+i)],["成员变量","a:a","b:b","c:c","d:d"]],"固定值<>i:-999~999+1|增加值<>i:-999~999+1"]},{n:"游戏控制",ico:"warp",ind:3.05,p:e,pn:[""],t:[["新游戏","继续游戏"]]},{n:"切换房间\n",ico:"warp",ind:3.06,p:c,pn:["房间"," 效果"],t:[["下一房间:128","当前房间:0",["指定房间",()=>$E._R.map(i=>i.name+":"+(i.id-$E._r.id))]],["淡入淡出","无效果"]]},{n:"音乐控制",ico:"snd",ind:3.07,p:e,pn:[""],t:[["播放","暂停","重置"]]}],[{n:"开始(继续)时间轴",ico:"timer",ind:4.01,p:e,pn:["编号"],t:["i:0~999+1-0"]},{n:"暂停时间轴",ico:"timer",ind:4.02,p:e,pn:["编号"],t:["i:0~999+1-0"]},{n:"停止(重置)时间轴",ico:"timer",ind:4.03,p:e,pn:["编号"],t:["i:0~999+1-0"]},{n:"设置时间轴节拍",ico:"timer",ind:4.04,p:e,pn:["1拍时长"],t:["i:1~6000+1-50"]},{n:"执行条件触发",ico:"logic",ind:4.05,p:e,pn:["编号"],t:["i:0~999+1-0"]}],[{n:"播放音效",ico:"snd",ind:5.01,p:c,pn:["","音高"],t:[[["玩家","射击:st","跳跃:jp","死亡:dth"],["机关","机关:bc","破坏:brk","Spike:spk","Cherry:chr"],["物体","弹簧:spr","金币:coin"],["Boss","打击:hit","弹幕:bst"],["音效","音效1:ej","音效2:gj","音效3:lj"]],"i:-36~36+1"]},{n:"创建残影",ico:"act",ind:5.02,p:[1,2,3,4,5,6,7],pn:["淡出时长","x缩放速度","y缩放速度","水平速度","竖直速度","重力","旋转速度"],t:["i:2~1000+1-10","i:-0.5~5+0.01","i:-0.5~5+0.01",o,o,"固定值<>i:0~1+0.01|随机值<>i:0~1+0.01,~>i:0~1+0.01","固定值<>i:-180~180+0.1-0|随机值<>i:-180~180+0.1,~>i:-180~180+0.1"],c:16}],[],[{n:"+1跳",ico:"ply",ind:7.01,p:e,pn:[""],t:[["刷新一次跳跃","增加一次跳跃"]],c:8},{n:"改变跳跃段数",ico:"ply",ind:7.02,p:e,pn:["(-1为无限跳)"],t:["i:-1~10+1-2"],c:8},{n:"改变玩家重力方向",ico:"ply",ind:7.03,p:e,pn:[""],t:[["向下:270","向上:90","向右:0","向左:180"]],c:8},{n:"设置玩家运动",ico:"ply",ind:7.04,p:c,pn:["速度","方向"],t:[d,n],c:8}],[{n:"触发器",ico:"trg",ind:1.01,p:[2,3,1],pn:["编号","",""],t:["i:0~999+1-0",["开启","关闭"],r]},{n:"位置",ico:"position",ind:1.02,p:[2,3,4,1],pn:["","","",""],t:[["x","y"],a,i,r]},{n:"显示",ico:"see",ind:1.03,p:[2,1],pn:["",""],t:[["可见","不可见"],r]},{n:"属性",ico:"label",ind:1.04,p:[2,3,4,1],pn:["","","",""],t:[["缩放x:scx","缩放y:scy","角度:ang","透明度:al","速度:sp","方向:di","水平速度:hsp","竖直速度:vsp","子图像:ind"],a,"i:-999.9~999.9+0.1",r],c:2},{n:"玩家位置\n",ico:"ply",ind:1.05,p:[2,3,4,1],pn:["","","",""],t:[["x","y"],a,i,r],c:8},{n:"玩家属性\n",ico:"ply",ind:1.06,p:[2,3,4,1],pn:["","","",""],t:[["水平速度:hspd","竖直速度:vspd","移动速度:moveSpd","重力大小:grav","重力方向:g_","跳跃段数:jump"],a,"i:-999.9~999.9+0.1",r],c:8},{n:"变量",ico:"label",ind:1.07,p:[2,3,4,1],pn:["","","",""],t:[[["全局变量",()=>Object.keys($E.GAME.VAR).map(i=>i+":0"+i)],["成员变量","a:a","b:b","c:c","d:d"]],a,"i:-999~999+1",r]},{n:"游戏信息\n",ico:"label",ind:1.08,p:[2,3,4,1],pn:["","","",""],t:[["时间(分钟):tMin","死亡:dth","存档状态:svS"],a,"i:0~9999+1",r]}],[{n:"碰撞",ico:"col",ind:2.01,p:[2,1],pn:["",""],t:[f,r],c:1},{n:"离开",ico:"col",ind:2.02,p:[2,1],pn:["",""],t:[f,r],c:1},{n:"碰撞中",ico:"col",ind:2.03,p:[2,1],pn:["",""],t:[f,r],c:1},{n:"未碰撞",ico:"col",ind:2.04,p:[2,1],pn:["",""],t:[f,r],c:1}],[{n:"按下键盘",ico:"keyboard",ind:3.01,p:[2,1],pn:["",""],t:[s,r],c:4},{n:"松开键盘",ico:"keyboard",ind:3.02,p:[2,1],pn:["",""],t:[s,r],c:4},{n:"按住键盘",ico:"keyboard",ind:3.03,p:[2,1],pn:["",""],t:[s,r],c:4},{n:"按下鼠标",ico:"click",ind:3.04,p:[2,1],pn:["",""],t:[h,r],c:4},{n:"松开鼠标",ico:"click",ind:3.05,p:[2,1],pn:["",""],t:[h,r],c:4},{n:"按住鼠标",ico:"click",ind:3.06,p:[2,1],pn:["",""],t:[h,r],c:4}]];const u=El("div","mb");u.onmouseleave=function(){this._h()},u.push=function(i){return this.ap(El("div","op arr").tx(i)).ap(El("div","mb"))},u.chkLib=(i,t)=>{let d=i.ch[0].ch,o=0;for(let i=d.length;i--;){let n=d[i].lib;d[i]._s(),n.c&&n.c&t?d[i]._h():o=1}o?i._s():i._h()},u.set=(i,t,d)=>{if(!$E.$O)return;let o=i.offsetLeft+(i.offsetWidth>100?16:i.offsetWidth),n=i.offsetTop,e=u.ch,c=$E.$O[0];for(u.node=i.pN,u.m=i.hC("tml-add");!i.hC("cat");)o+=(i=i.pN).offsetLeft,n+=i.offsetTop;if(i.pN.ap(u)._s(),css(u,{top:`${n+4}px`,left:o-16+"px"}),css(u.ch,{display:"none",border:"none"}),4===t||6===t){for(let i=3;i<9;i++)u.chkLib(e[i],c.lib);0===$E._r.type||4===$E._r.type?e[6].ch[0].ch[4]._s():e[6].ch[0].ch[4]._h(),e=e[4].ch[0].ch;for(let i=e.length;i--;){let t=e[i].lib;(t.apl&&t.apl.some(i=>void 0===c.add[i])||t.r&&_r.type!==t.r-1)&&e[i]._h()}e=u.ch,u.obj=d,u.add=null}switch(t){case 0:e=e[2],e._s(),e=e.ch[0].ch;for(let i=e.length;i--;){let t=e[i].lib;e[i]._s(),t.apl&&t.apl.some(i=>void 0===c.add[i])&&e[i]._h();let d=c.add;d&&t.p.some(i=>void 0!==d[i]||void 0!==c.add[i])&&e[i]._h(),t.c&&t.c&c.lib&&e[i]._h()}u.obj=c,u.add=c.add;break;case 1:if(e=e[3],e._s(),c.add.mov){e=e.ch[0].ch;let i=c.add.mov;for(let t=e.length;t--;){let d=e[t].lib;i.find(i=>i[0]===d.ind)?e[t]._h():e[t]._s(),d.c&&d.c&c.lib&&e[t]._h()}}else c.add.mov=[],u.chkLib(e,c.lib);u.obj=c.add.mov,u.add=null;break;case 2:$E.C._U(),c.add.tml||(c.add.tml=[]);let i=[1,[]];i.i=c.add.tml.push(i)-1,this.apAc(c.add.tml,i,this.acLib[2][0],u.node);break;case 3:$E.C._U(),c.add.trg||(c.add.trg=[]);let t=[1,1,[],[]];t.i=c.add.trg.push(t)-1,this.apAc(c.add.trg,t,this.acLib[3][0],u.node);break;case 4:e[0]._s(),e[1]._s();break;case 5:for(let i=11;i<14;i++)u.chkLib(e[i],c.lib);u.obj=d,u.add=null}},this.acLib.set=(i,t)=>{let d=El("div","op");d.innerHTML=UI.ico(t.ico)+" "+t.n,d.lib=t,i.ap(d),d.onclick=function(){if($E.$O&&u.obj){if($E.C._U(),u.m){let i=[this.lib.ind],t=u.node.pro.i;i.i=t,u.add=i,u.obj.splice(t,0,i);for(let i=t+1;i<u.obj.length;i++){let d=u.obj[i];d.i=i,.02===d[0]&&d[1]>=t&&(d[1]++,d.set())}}else if(!u.add){let i=[];i.i=u.obj.push(i)-1,u.add=i,void 0!==this.lib.ind&&(i[0]=this.lib.ind)}$E.pro.apAc(u.obj,u.add,this.lib,u.node,1,u.m),u._h()}}},this.acLib[4].for(i=>this.acLib.set(u,i)),this.acLib.slice(0,2).for((i,t)=>{let d=u.push(0===t?"0{cr}":"0{cs}");this.acLib[t].for((i,t)=>{i.h||this.acLib.set(d,i)})}),["0{ct}","0{cu}","0{cv}","0{cw}","0{18}","0{cx}","0{b9}","0{bn}","0{cy}","0{cz}"].for((i,t)=>{let d=u.push(i);this.acLib[5+t].for(i=>this.acLib.set(d,i))}),$c("page")[3].ap(u),u._h(),css(u.ch,{minWidth:"32px",borderRadius:"4px"}),this.acChs=u},_lock:!1,get lock(){return this._lock},set lock(i){i!==this._lock&&(this._lock=i,i?$E._O&&($E._O.style.borderColor="",$E._O=null):($E.sfE.canvas.style.opacity=.6,$E.$O=null,$E.C.dM(0,0,1)))}},$E.$P=(i,t)=>{$E.inEdit&&$E.exitEdit();const d=$c("p-ev"),o=["0{w}","0{d0}","0{cp}","0{cq}"],n=$E.pro;if(n.buildIn=t,d.for((i,t)=>{i.innerHTML=`<h4>${o[t]}</h4>`,i.style.paddingBottom="",i.firstChild.onclick=t=>{t.target===i.firstChild&&(i.hC("fold")?i.rC("fold"):i.aC("fold"),$E.fixH($c("cat")[18]))}}),$c("mb").for(i=>{i.pN.hC("op")||i.remove()}),i){let e=i[0];if(t)$("p-name").tx(t.name).ap(UI.B2("0{d1}").on(()=>$E.GAME.R.for(i=>{0!==i.type&&i!==$E._r&&(i.bobj[t.id].add=$M.cp(e.add))}))),$E.drawThn($("p-spr").ch[0],t.spr),$E.pro.lock=!0;else{let t=Lib.obj[e.cid].n;if($("p-name").tx(1===i.length?t:`${t} 等${i.length}个物体`),e.spr.for((i,t)=>$E.drawThn($("p-spr").ch[0],i,0===t)),0===e.ind)return}d.for((i,d)=>{i.i=d;let e=i.firstChild;const c=$E.$O;t||(e.ap(El("div","p-btn",{innerHTML:UI.ico("copy")+`<div>0{91}${o[d]}</div>`})).onclick=function(){let i=this.pN.pN.i;if(0===i){let i={...c[0].add};delete i.mov,delete i.tml,delete i.trg,n.clipBoard[0]=i}else{let t=JSON.stringify(c[0].add[["mov","tml","trg"][i-1]]);n.clipBoard[i]=t?JSON.parse(t):[]}},n.clipBoard[d]&&(e.ap(El("div","p-btn",{innerHTML:UI.ico("paste")+`<div>0{92}${o[d]}</div>`})).onclick=function(){let i=this.pN.pN.i;n.applyPro(i,n.clipBoard[i],c),$E.reloadPro()}),c.length>1&&(e.ap(El("div","p-btn",{innerHTML:`${UI.ico("brush")}<div>0{d2}</div>`})).onclick=function(){let i=this.pN.pN.i;if(0===i)n.applyPro(i,c[0].add,c.slice(1));else{let t=JSON.stringify(c[0].add[["mov","tml","trg"][i-1]]);n.applyPro(i,t?JSON.parse(t):[],c.slice(1))}})),t&&!t.add[d]||(i.style.paddingBottom="28px",i.ap(El("div","p-add",{innerHTML:UI.ico("add")+"0{7f}"})).onclick=function(){n.acChs.set(this,this.pN.i)})});const c=n.acLib;(!t||t&&void 0!==e.x)&&n.apAc(e,e.add,c[0][0],d[0],0),void 0!==e.add.til&&n.apAc(e,e,c[0][17],d[0],0);for(let i in e.add)switch(i){case"mov":e.add.mov.for((i,t)=>{i.i=t,n.apAc(e.add.mov,i,c[1][i[0]],d[1],!0)});break;case"tml":e.add.tml.for((i,t)=>{i.i=t;let o=n.apAc(e.add.tml,i,c[2][0],d[2],!0);o.aC("fold"),i[1].for((t,d)=>{t.i=d,n.apAc(i[1],t,n.actInd(t[0]),o,!0)})});break;case"trg":e.add.trg.for((i,t)=>{i.i=t;let o=$c("p-ac",n.apAc(e.add.trg,i,c[3][0],d[3],!0));i[2].for((t,d)=>{t.i=d,n.apAc(i[2],t,n.conInd(t[0]),o[0],!0)}),i[3].for((t,d)=>{t.i=d,n.apAc(i[3],t,n.actInd(t[0]),o[1],!0)})});break;default:let t=c[0].find(t=>t.p[0]==i);!t||t.c&&t.c&e.lib||n.apAc(e,e.add,t,d[0],t.del)}$E.C.dM(0,0,1)}else $E.$O=null,$E.pro.lock=!1,$("p-spr").ch[0].getContext("2d").clearRect(0,0,32,32),$("p-name").tx("0{1i}"),$("p-info").tx(""),$E.fixH($c("cat")[18]),$("screen").out?$E.C.dM(0,0,1):$E.C.dM(...$E.C.cXY())},$E.reloadPro=()=>{let i=$E.C.editPos();$E.$P($E.$O,$E.pro.buildIn),$E.C.rcPos(i)},$E.preset={create(i,t,d,o){let n={n:o??Lib._o[i].n,ind:i,id:t,add:$M.cp(Lib._o[i].add)};return this._o[i]&&(this._o[i].sc&&(n.sc=1),this._o[i].ang&&(n.ang=1),this._o[i].a&&(n.a=1)),d&&Object.assign(n.add,d),n},init(){const i={6:{trg:[[1,1,[[2.01,0,1]],[[5.01,"brk",0],[3.01,1]]]]},19:{mov:[[4,.4,270],[13,0,0]]},23:{trg:[[1,1,[[2.01,0,0]],[[7.04,[0,10],[2,90]],[3.02,1],[5.01,"spr",0]]]]},24:{trg:[[1,0,[[2.01,0,0]],[[7.04,[0,10],[2,90]]]]]},25:{trg:[[1,1,[[2.01,0,0]],[[7.01,0],[5.01,"ej",0],[3.01,0]]]]},26:{trg:[[1,0,[[1.06,0,"jump",5,2],[2.01,0,0]],[[7.02,2],[5.01,"lj",0],[5.02,25,.05,.05,[0,0],[0,0],[0,0],[0,0]]]]]},27:{trg:[[1,0,[[1.06,0,"jump",5,2],[2.01,0,0]],[[7.02,2],[5.01,"lj",0],[5.02,25,.05,.05,[0,0],[0,0],[0,0],[0,0]]]]]},28:{trg:[[1,0,[[1.06,0,"jump",5,1],[2.01,0,0]],[[7.02,1],[5.01,"lj",0],[5.02,25,.05,.05,[0,0],[0,0],[0,0],[0,0]]]]]},29:{trg:[[1,0,[[1.06,0,"jump",5,-1],[2.01,0,0]],[[7.02,-1],[5.01,"gj",0],[5.02,25,.05,.05,[0,0],[0,0],[0,0],[0,0]]]]]},34:{trg:[[1,0,[[2.01,0,0]],[[7.03,90]]]]},35:{trg:[[1,0,[[2.01,0,0]],[[7.03,270]]]]},36:{hd:1,trg:[[0,1,[[2.01,0,0]],[[3.03,0,0]]]]},37:{trg:[[0,1,[[2.01,0,1]],[[3.03,0,0],[3.02,1]]]]},38:{trg:[[0,1,[[2.01,0,0]],[[3.03,0,0],[3.02,1]]]]},41:{trg:[[2,0,[[2.01,0,0]],[[3.02,1]]],[2,0,[[2.02,0,0]],[[3.02,0]]]]},50:{al:0,trg:[[1,0,[[2.01,0,1]],[[1.05,[0,1],1],[1.05,[0,0],20]]]]}},t=[1,2,3,5,6,50,7,8,9,13,14,21,36,40,43,44,45,46,47,48],d=[7,11,13,14,23,24,37,40],o=[25,21,38];Lib._o.for((n,e)=>{let c=this.create(e,e,i[e]);t.includes(e)&&(c.sc=1),d.includes(e)&&(c.ang=1),o.includes(e)&&(c.a=1),this._o[e]=c}),this._o.push(this.create(3,500,{cm:0,trg:[[1,1,[[2.01,0,0]],[[3.01,1],[5.01,"brk",0]]]]},"假砖块"),this.create(3,501,{hd:1,trg:[[2,1,[[2.01,0,0]],[[1.04,0],[5.01,"bc",0]]]]},"隐藏砖块"),this.create(10,502,{gpm:[1,8,96],csc:0,cag:0,mov:[[6,[0,1]]]},"圆圈")),this.spr={};for(let i in Res.spr)this.spr[i]=El("canvas",0,{width:32,height:32}),$E.drawThn(this.spr[i],Res.spr[i],0)},_o:[],_l:[[0,1,2],[3,500,501,4,5,6,50],[7,8,9,11,12],[10,502,13,14,15,16,49,17,18,19,25,20,51,21,22,23,24],[26,27,28,29,30,31,32,33,34,35],[36,37,38],[39,40,41,42,43,44,45,46,47,48]],_h:[500,501],_O(i){let t=El("div","obj"),d=El("canvas",0,{width:32,height:32});return t.ap(El("div"),El("p","a-cen").tx(i.n),d),t.obj=i,t.o={...Lib.obj[i.id]},i.sc&&(t.o.scx=t.o.scy=1),i.ang&&(t.o.ang=0),t.a=i.a??0,t.spr=t.o.spr.map(i=>Res.spr[i]),t.onclick=()=>{$E._O&&($E._O.style.borderColor=""),t.style.borderColor="#fd0",$E._O=t,$E.pro.lock=!1},d.getContext("2d").drawImage(this.spr[t.o.spr[0]],0,0),t},set(){let i=$E.GAME._o??[],t=$E.GAME._l??this._l,d=$E.GAME._h??this._h,o=$c("cat",$("page"));Lib.obj.length=0,t.for((t,n)=>{let e=o[8+n],c=$S.get("grp"+(8+n));$c("obj",e).for(i=>i.remove()),t.for(t=>{let o=(t<1e3?this._o:i).find(i=>i.id===t);if(o){Lib.obj[t]=$M.freeze({...Lib._o[o.ind],n:o.n,ind:o.ind,cid:o.id,add:o.add});let i=this._O(o);d.includes(t)&&(i.hide=1,c&&i._h()),e.ap(i)}}),$E.fixH(e)})},_:{0:{pro:[],mov:[],trg:[],tml:[],cod:[],act:[]},1:{pro:[],mov:[],trg:[],tml:[],cod:[],act:[]}},import(){},export(){}};